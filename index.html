<!DOCTYPE html>
<html>
<head>
    <title>Open Venmo</title>
    <script src="venmo.js"></script>
</head>
<body>
    <p>If Venmo does not open automatically, click here: <a id="venmo-link" href="#">Open Venmo</a><br>
    Venmo Deeplink: <span id="deeplink-text"></span></p>
    <script>
        window.addEventListener('DOMContentLoaded', async () => {
            const latestData = await fetchLatestVenmoLink();
            const deeplink = latestData
                ? getVenmoDeeplink(
                    latestData.recipient,
                    (parseFloat(latestData.sum) / parseInt(latestData.num)).toFixed(2),
                    latestData.note
                  )
                : getVenmoDeeplink("IronCarrot", "1", "test payment");
            document.getElementById('venmo-link').href = deeplink;
            document.getElementById('deeplink-text').textContent = deeplink;
            window.location.href = deeplink;
        });
    </script>
</body>
</html>
